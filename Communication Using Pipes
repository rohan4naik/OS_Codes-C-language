/* Assignment Pipes */

1way
#include <stdio.h>
#include <unistd.h>   
#include <string.h>
#include <sys/wait.h>

int main() {
    int fd[2];  //fd[0] = read end, fd[1] = write end
    pid_t pid;
    char m[100];
    char buffer[100]; 

    if (pipe(fd) == -1) {
        printf("Pipe creation failed!\n");
        return 1;
    }

    pid = fork();

    if (pid < 0) {
        printf("Fork failed!\n");
        return 1;
    }

    if (pid > 0) {
        // ---------------- Parent Process ----------------
        close(fd[0]);

        printf("Enter a message from parent: ");
        fgets(m, sizeof(m), stdin);

        write(fd[1], m, strlen(m) + 1);
        close(fd[1]);

        wait(NULL);
        printf("Parent process finished.\n");

    } else {
        // ---------------- Child Process ----------------
        close(fd[1]);

        read(fd[0], buffer, sizeof(buffer));
        close(fd[0]);
        printf("Child received message: %s\n", buffer);
    }

    return 0;
}
2-Way

#include <stdio.h>

#include <sys/types.h>

#include <sys/ipc.h>

#include <sys/wait.h>

#include <unistd.h>

#define MAX 20

 

int main()

{

    int pipe1[2], pipe2[2], n;

    char send[MAX], receive[MAX];

 

    if (pipe(pipe1) == -1 || pipe(pipe2) == -1) {

        printf("\nError in pipe creation.\n\n");

        return 0;

    }
    pid_t pid = fork();

    if (pid < 0) {

        printf("\nError in fork.\n\n");

        return 0;

    } else if (pid > 0) {                                                   // parent

        close(pipe1[0]);                                                    // parent will send from pipe1

        printf("\nEnter the message from parent to child : ");

 

        if (fgets(send, sizeof(send), stdin) == NULL) {

            printf("\nError in taking the input.\n\n");

            close(pipe1[1]);

            return 0;
        }
        write(pipe1[1], send, sizeof(send));

        close(pipe1[1]);
        n = read(pipe2[0], receive, sizeof(receive));
        if (n == -1) {

            printf("\nError in reading the message.\n\n");

            return 0;

        }
        close(pipe2[0]);

        printf("\nMessage received by the parent is : %s\n", receive);

 

        wait(NULL);

        printf("\n---------- Parent Process Ends -----------
\n");

    } else {                                                                // child

        close(pipe2[0]);                                                    // child will send from pipe2
        n = read(pipe1[0], receive, sizeof(receive));
        if (n == -1) {

            printf("\nError in reading the message.\n\n");
            return 0;

        }
        close(pipe1[0]);
        printf("\nMessage received by the child is : %s\n", receive);
        printf("\nEnter the message from child to parent : ");
        if (fgets(send, sizeof(send), stdin) == NULL) {

            printf("\nError in getting input.\n");
            close(pipe2[1]);
            return 0;
        }
        write(pipe2[1], send, sizeof(send));
        close(pipe2[1]);
    }
    return 0;
}
